const db = require('./index')
const fs = require('fs')
const path = require('path')
const jsonFile = path.resolve(__dirname, './data.json') //此处为你的json文件
const read = fs.readFileSync(jsonFile, 'utf-8')
console.log('typeof read', typeof read)
// console.log('read', read)
const jsonObj = JSON.parse(read)

const insertJson = () => {
  for (let w of jsonObj) {
    try {
      let addSql = `INSERT INTO dashboard_score
      (school,subject,year,name,score)
       VALUES(?,?,?,?,?,?,?)`
      let addSqlParams = [w.school, w.subject, w.year, w.name, w.score]
      db.query(addSql, addSqlParams)
    } catch (error) {
      console.log(`Error: ${error}`)
    }
  }
}

const initUserTable = async () => {
  const deleteTxt = `DROP TABLE IF EXISTS "dashboard_users"`
  await db.query(deleteTxt)
  const text = `
    CREATE TABLE IF NOT EXISTS "dashboard_users" (
	    "id" SERIAL,
	    "username" VARCHAR(100) NOT NULL,
	    "password" TEXT NOT NULL,
	    "token" TEXT NOT NULL,
	    PRIMARY KEY ("id")
    );`
  await db.query(text)
}

const initScoreTable = async () => {
  const deleteTxt = `DROP TABLE IF EXISTS "dashboard_score"`
  await db.query(deleteTxt)

  const text = `
  CREATE TABLE IF NOT EXISTS "dashboard_score" (
    "id" SERIAL,
    "school" VARCHAR(100) NOT NULL,
    "subject" TEXT NOT NULL,
    "year" INT NOT NULL,
    "name" TEXT NOT NULL,
    "score" INT NOT NULL,
    PRIMARY KEY ("id")
  );`
  await db.query(text)
  const existData = await db.query(`select * from dashboard_score`)
  console.log('existData.rows', existData.rows)
  if (!existData.rows.length) {
    // insertJson()
    const text = `
    INSERT INTO
    "dashboard_score" ("school", "subject", "name", "year", "score")
  VALUES
    ('B', 'English', 'daniel', 2020, 79),
    ('A', 'Maths', 'ben', 2020, 32),
    ('A', 'Maths', 'helen', 2020, 24),
    ('A', 'Maths', 'helen', 2020, 39),
    ('C', 'English', 'jill', 2018, 42),
    ('A', 'Physics', 'jill', 2019, 24),
    ('B', 'English', 'helen', 2022, 86),
    ('B', 'Physics', 'jill', 2020, 72),
    ('C', 'Physics', 'jill', 2018, 22),
    ('B', 'Physics', 'sally', 2022, 55),
    ('C', 'English', 'daniel', 2019, 41),
    ('A', 'Maths', 'jill', 2019, 86),
    ('A', 'Physics', 'daniel', 2018, 78),
    ('B', 'Physics', 'jill', 2020, 70),
    ('A', 'Maths', 'helen', 2018, 72),
    ('B', 'Maths', 'daniel', 2020, 75),
    ('A', 'Maths', 'daniel', 2022, 96),
    ('A', 'Physics', 'ben', 2019, 85),
    ('C', 'English', 'daniel', 2019, 88),
    ('B', 'Maths', 'sally', 2022, 26),
    ('A', 'English', 'helen', 2022, 91),
    ('C', 'English', 'helen', 2022, 29),
    ('C', 'English', 'daniel', 2022, 57),
    ('C', 'English', 'ben', 2018, 23),
    ('B', 'Physics', 'jill', 2020, 67),
    ('C', 'English', 'helen', 2022, 72),
    ('C', 'Maths', 'ben', 2021, 92),
    ('C', 'Physics', 'ben', 2022, 94),
    ('C', 'Maths', 'jill', 2019, 60),
    ('A', 'Maths', 'sally', 2021, 97),
    ('A', 'English', 'jill', 2018, 89),
    ('B', 'Physics', 'ben', 2018, 10),
    ('A', 'Physics', 'sally', 2019, 88),
    ('B', 'Maths', 'sally', 2021, 30),
    ('B', 'Maths', 'ben', 2019, 85),
    ('C', 'Maths', 'jill', 2021, 66),
    ('C', 'Physics', 'daniel', 2019, 9),
    ('A', 'Maths', 'ben', 2020, 34),
    ('B', 'Maths', 'helen', 2019, 11),
    ('C', 'Physics', 'ben', 2021, 44),
    ('A', 'Physics', 'ben', 2020, 48),
    ('B', 'Maths', 'ben', 2020, 26),
    ('B', 'English', 'sally', 2018, 85),
    ('A', 'English', 'jill', 2021, 40),
    ('A', 'English', 'daniel', 2018, 80),
    ('B', 'Physics', 'sally', 2022, 17),
    ('B', 'Maths', 'ben', 2020, 79),
    ('B', 'Maths', 'ben', 2020, 6),
    ('B', 'English', 'jill', 2019, 78),
    ('A', 'English', 'helen', 2018, 94),
    ('C', 'English', 'sally', 2018, 76),
    ('A', 'Maths', 'ben', 2018, 41),
    ('B', 'English', 'jill', 2019, 1),
    ('A', 'Physics', 'helen', 2019, 14),
    ('A', 'Maths', 'ben', 2019, 55),
    ('A', 'Maths', 'ben', 2019, 53),
    ('B', 'Maths', 'ben', 2021, 62),
    ('A', 'Physics', 'daniel', 2020, 31),
    ('A', 'Maths', 'daniel', 2019, 96),
    ('C', 'Maths', 'helen', 2018, 50),
    ('A', 'Physics', 'jill', 2019, 51),
    ('B', 'Physics', 'ben', 2021, 10),
    ('A', 'Maths', 'ben', 2022, 2),
    ('B', 'English', 'helen', 2020, 76),
    ('A', 'Maths', 'daniel', 2019, 32),
    ('A', 'Physics', 'sally', 2021, 99),
    ('C', 'Maths', 'daniel', 2021, 45),
    ('C', 'Maths', 'ben', 2021, 46),
    ('B', 'English', 'sally', 2018, 21),
    ('A', 'Physics', 'daniel', 2020, 91),
    ('B', 'Physics', 'ben', 2018, 92),
    ('C', 'Maths', 'daniel', 2020, 71),
    ('B', 'Physics', 'sally', 2018, 5),
    ('B', 'English', 'ben', 2019, 78),
    ('A', 'Physics', 'ben', 2019, 70),
    ('B', 'English', 'sally', 2020, 31),
    ('C', 'English', 'sally', 2022, 70),
    ('A', 'Maths', 'daniel', 2018, 22),
    ('A', 'Maths', 'daniel', 2019, 34),
    ('A', 'English', 'helen', 2019, 7),
    ('B', 'English', 'sally', 2018, 0),
    ('C', 'English', 'helen', 2022, 24),
    ('C', 'Physics', 'jill', 2021, 29),
    ('A', 'Physics', 'daniel', 2021, 80),
    ('C', 'Physics', 'jill', 2021, 88),
    ('C', 'English', 'daniel', 2018, 45),
    ('C', 'English', 'ben', 2019, 53),
    ('C', 'Physics', 'ben', 2022, 16),
    ('A', 'Physics', 'sally', 2018, 31),
    ('B', 'Physics', 'jill', 2021, 66),
    ('C', 'Maths', 'jill', 2022, 33),
    ('C', 'Maths', 'jill', 2020, 68),
    ('B', 'English', 'helen', 2021, 68),
    ('A', 'Maths', 'helen', 2018, 20),
    ('B', 'English', 'jill', 2019, 52),
    ('B', 'Maths', 'ben', 2022, 73),
    ('B', 'Physics', 'daniel', 2018, 33),
    ('B', 'Maths', 'helen', 2020, 46),
    ('C', 'English', 'jill', 2019, 22),
    ('A', 'Physics', 'jill', 2022, 45),
    ('C', 'Physics', 'helen', 2021, 65),
    ('C', 'Maths', 'helen', 2021, 25),
    ('A', 'English', 'sally', 2018, 10),
    ('B', 'Physics', 'ben', 2020, 87),
    ('A', 'Physics', 'jill', 2021, 83),
    ('B', 'Maths', 'helen', 2020, 85),
    ('B', 'Physics', 'sally', 2022, 24),
    ('A', 'English', 'sally', 2022, 63),
    ('A', 'English', 'daniel', 2021, 56),
    ('C', 'English', 'jill', 2022, 64),
    ('A', 'Physics', 'jill', 2022, 92),
    ('A', 'Physics', 'ben', 2020, 6),
    ('C', 'English', 'daniel', 2019, 50),
    ('C', 'English', 'sally', 2022, 66),
    ('B', 'Physics', 'ben', 2020, 21),
    ('A', 'Maths', 'daniel', 2022, 66),
    ('C', 'Physics', 'sally', 2020, 36),
    ('B', 'Physics', 'helen', 2018, 9),
    ('A', 'Maths', 'sally', 2020, 29),
    ('B', 'Maths', 'sally', 2019, 52),
    ('A', 'English', 'daniel', 2020, 36),
    ('A', 'Maths', 'jill', 2018, 12),
    ('C', 'Physics', 'ben', 2019, 21),
    ('C', 'Maths', 'helen', 2021, 12),
    ('B', 'Maths', 'helen', 2018, 97),
    ('B', 'Maths', 'helen', 2020, 95),
    ('B', 'English', 'helen', 2022, 39),
    ('B', 'Physics', 'sally', 2020, 14),
    ('C', 'Maths', 'ben', 2020, 76),
    ('C', 'Physics', 'daniel', 2020, 70),
    ('A', 'Maths', 'sally', 2022, 38),
    ('C', 'Physics', 'jill', 2021, 33),
    ('B', 'Physics', 'ben', 2021, 34),
    ('A', 'Maths', 'jill', 2021, 17),
    ('C', 'Physics', 'daniel', 2020, 92),
    ('B', 'English', 'jill', 2021, 1),
    ('B', 'English', 'jill', 2022, 59),
    ('C', 'Maths', 'helen', 2018, 46),
    ('B', 'English', 'daniel', 2020, 31),
    ('B', 'English', 'daniel', 2021, 35),
    ('B', 'Physics', 'jill', 2018, 5),
    ('C', 'Physics', 'daniel', 2018, 64),
    ('A', 'Maths', 'daniel', 2020, 56),
    ('C', 'English', 'ben', 2022, 36),
    ('A', 'English', 'jill', 2021, 78),
    ('A', 'Physics', 'helen', 2018, 14),
    ('C', 'English', 'daniel', 2018, 41),
    ('A', 'English', 'daniel', 2019, 18),
    ('C', 'Physics', 'sally', 2021, 87),
    ('C', 'Maths', 'helen', 2020, 64),
    ('A', 'Physics', 'helen', 2018, 15),
    ('C', 'English', 'sally', 2019, 91),
    ('B', 'Maths', 'daniel', 2019, 77),
    ('C', 'English', 'helen', 2022, 84),
    ('C', 'English', 'jill', 2022, 52),
    ('A', 'English', 'sally', 2018, 23),
    ('C', 'Physics', 'helen', 2018, 21),
    ('C', 'Physics', 'helen', 2021, 24),
    ('A', 'Physics', 'sally', 2021, 32),
    ('A', 'Physics', 'ben', 2018, 18),
    ('C', 'Physics', 'ben', 2022, 10),
    ('C', 'Maths', 'ben', 2022, 59),
    ('C', 'Maths', 'helen', 2021, 29),
    ('C', 'Physics', 'daniel', 2019, 12),
    ('B', 'Maths', 'sally', 2018, 93),
    ('B', 'Maths', 'ben', 2018, 24),
    ('A', 'Physics', 'daniel', 2019, 28),
    ('B', 'English', 'sally', 2020, 72),
    ('B', 'English', 'jill', 2020, 50),
    ('B', 'Maths', 'jill', 2022, 18),
    ('C', 'Maths', 'daniel', 2019, 73),
    ('B', 'English', 'daniel', 2020, 4),
    ('A', 'English', 'helen', 2022, 6),
    ('B', 'English', 'sally', 2019, 86),
    ('A', 'Physics', 'daniel', 2018, 83),
    ('A', 'English', 'ben', 2021, 54),
    ('B', 'Maths', 'jill', 2020, 30),
    ('B', 'Physics', 'sally', 2022, 78),
    ('A', 'English', 'daniel', 2022, 4),
    ('B', 'English', 'helen', 2018, 35),
    ('C', 'Maths', 'helen', 2019, 33),
    ('B', 'Maths', 'jill', 2021, 22),
    ('A', 'English', 'sally', 2020, 9),
    ('A', 'Physics', 'sally', 2019, 16),
    ('C', 'Maths', 'sally', 2020, 18),
    ('A', 'Maths', 'jill', 2020, 2),
    ('C', 'English', 'helen', 2019, 45),
    ('C', 'Maths', 'helen', 2022, 45),
    ('C', 'Physics', 'helen', 2019, 19),
    ('A', 'Physics', 'sally', 2022, 82),
    ('A', 'Physics', 'jill', 2022, 84),
    ('A', 'Maths', 'jill', 2021, 42),
    ('A', 'Maths', 'daniel', 2020, 22),
    ('C', 'Maths', 'daniel', 2022, 99),
    ('C', 'Physics', 'sally', 2021, 79),
    ('A', 'Physics', 'ben', 2022, 25),
    ('A', 'Maths', 'sally', 2019, 10),
    ('C', 'English', 'sally', 2018, 20),
    ('C', 'Physics', 'helen', 2022, 22),
    ('C', 'English', 'daniel', 2019, 91),
    ('B', 'Physics', 'jill', 2019, 37),
    ('A', 'Physics', 'sally', 2022, 66),
    ('A', 'English', 'daniel', 2018, 64),
    ('A', 'Maths', 'sally', 2022, 35),
    ('A', 'English', 'helen', 2019, 20),
    ('A', 'Maths', 'helen', 2020, 63),
    ('C', 'Maths', 'jill', 2019, 44),
    ('B', 'Maths', 'jill', 2021, 76),
    ('C', 'English', 'daniel', 2018, 57),
    ('C', 'Maths', 'helen', 2020, 15),
    ('B', 'English', 'jill', 2019, 79),
    ('B', 'Maths', 'sally', 2018, 19),
    ('A', 'Maths', 'ben', 2018, 3),
    ('B', 'English', 'daniel', 2022, 80),
    ('C', 'Physics', 'jill', 2022, 44),
    ('C', 'Maths', 'helen', 2019, 51),
    ('A', 'Maths', 'helen', 2018, 87),
    ('C', 'English', 'sally', 2018, 16),
    ('B', 'English', 'daniel', 2022, 4),
    ('C', 'English', 'helen', 2020, 74),
    ('A', 'English', 'sally', 2022, 25),
    ('A', 'Physics', 'jill', 2018, 27),
    ('A', 'English', 'ben', 2021, 79),
    ('C', 'Maths', 'jill', 2019, 27),
    ('A', 'Maths', 'jill', 2019, 76),
    ('A', 'English', 'jill', 2021, 46),
    ('C', 'Physics', 'daniel', 2019, 80),
    ('C', 'Maths', 'ben', 2019, 26),
    ('A', 'English', 'jill', 2021, 3),
    ('C', 'English', 'ben', 2020, 93),
    ('B', 'Physics', 'jill', 2021, 13),
    ('A', 'Maths', 'sally', 2020, 10),
    ('A', 'Maths', 'daniel', 2021, 17),
    ('C', 'Physics', 'jill', 2022, 29),
    ('C', 'Maths', 'jill', 2021, 64),
    ('B', 'Physics', 'jill', 2021, 89),
    ('A', 'Physics', 'daniel', 2020, 30),
    ('C', 'English', 'jill', 2022, 15),
    ('A', 'English', 'ben', 2021, 39),
    ('A', 'English', 'ben', 2021, 85),
    ('C', 'Maths', 'sally', 2021, 76),
    ('C', 'Physics', 'ben', 2018, 67),
    ('C', 'Physics', 'daniel', 2019, 29),
    ('B', 'Physics', 'sally', 2021, 94),
    ('C', 'English', 'daniel', 2018, 38),
    ('C', 'Physics', 'daniel', 2018, 83),
    ('C', 'English', 'jill', 2020, 43),
    ('A', 'English', 'helen', 2022, 92),
    ('B', 'English', 'sally', 2019, 3),
    ('A', 'Physics', 'jill', 2022, 6),
    ('C', 'English', 'sally', 2019, 17),
    ('B', 'Maths', 'jill', 2019, 70),
    ('B', 'Physics', 'helen', 2019, 52),
    ('A', 'English', 'helen', 2020, 6),
    ('B', 'Physics', 'jill', 2020, 38),
    ('A', 'Maths', 'sally', 2022, 83),
    ('C', 'English', 'sally', 2022, 53),
    ('A', 'Physics', 'sally', 2018, 13),
    ('B', 'Maths', 'jill', 2020, 54),
    ('A', 'Maths', 'sally', 2020, 20),
    ('B', 'Maths', 'ben', 2019, 41),
    ('C', 'English', 'helen', 2021, 20),
    ('C', 'English', 'helen', 2022, 84),
    ('B', 'English', 'jill', 2018, 13),
    ('C', 'Maths', 'daniel', 2019, 30),
    ('B', 'English', 'ben', 2021, 6),
    ('A', 'Maths', 'daniel', 2020, 57),
    ('B', 'English', 'jill', 2019, 95),
    ('A', 'Maths', 'ben', 2020, 74),
    ('A', 'Maths', 'sally', 2019, 85),
    ('A', 'English', 'daniel', 2021, 97),
    ('B', 'Physics', 'daniel', 2021, 95),
    ('C', 'English', 'daniel', 2020, 52),
    ('B', 'Maths', 'ben', 2021, 27),
    ('A', 'Physics', 'ben', 2020, 50),
    ('B', 'Maths', 'daniel', 2021, 83),
    ('B', 'Physics', 'daniel', 2019, 18),
    ('C', 'Physics', 'helen', 2022, 52),
    ('A', 'Physics', 'daniel', 2018, 18),
    ('C', 'English', 'daniel', 2021, 19),
    ('A', 'English', 'sally', 2020, 46),
    ('A', 'English', 'sally', 2020, 17),
    ('A', 'Maths', 'ben', 2019, 83),
    ('A', 'English', 'helen', 2021, 91),
    ('C', 'Physics', 'ben', 2018, 57),
    ('B', 'Physics', 'helen', 2020, 31),
    ('A', 'English', 'jill', 2020, 3),
    ('A', 'English', 'jill', 2021, 18),
    ('B', 'Physics', 'daniel', 2022, 3),
    ('C', 'English', 'sally', 2018, 95),
    ('B', 'English', 'sally', 2020, 60),
    ('C', 'English', 'ben', 2019, 30),
    ('A', 'Maths', 'jill', 2020, 21),
    ('C', 'Maths', 'ben', 2018, 22),
    ('C', 'Physics', 'jill', 2019, 24),
    ('B', 'Physics', 'sally', 2021, 73),
    ('A', 'English', 'ben', 2022, 88),
    ('A', 'English', 'sally', 2018, 54),
    ('C', 'Physics', 'ben', 2019, 28),
    ('B', 'English', 'ben', 2018, 80);
    `
    await db.query(text)
  }
}

const createAllTables = () => {
  initUserTable()
  initScoreTable()
}

module.exports = createAllTables
